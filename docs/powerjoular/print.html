<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>PowerJoular Documentation</title>
        <meta name="robots" content="noindex" />


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="overview.html"><strong aria-hidden="true">1.</strong> Overview</a></li><li class="chapter-item expanded affix "><li class="part-title">User Guide</li><li class="chapter-item expanded "><a href="guide/supported_platforms.html"><strong aria-hidden="true">2.</strong> Supported Platforms</a></li><li class="chapter-item expanded "><a href="guide/installation.html"><strong aria-hidden="true">3.</strong> Installation</a></li><li class="chapter-item expanded "><a href="guide/quick_usage.html"><strong aria-hidden="true">4.</strong> Quick Usage</a></li><li class="chapter-item expanded affix "><li class="part-title">Reference Guide</li><li class="chapter-item expanded "><a href="ref/compilation.html"><strong aria-hidden="true">5.</strong> Compilation</a></li><li class="chapter-item expanded "><a href="ref/options.html"><strong aria-hidden="true">6.</strong> Command Line Options</a></li><li class="chapter-item expanded "><a href="ref/systemd.html"><strong aria-hidden="true">7.</strong> Systemd Service</a></li><li class="chapter-item expanded "><a href="ref/integration.html"><strong aria-hidden="true">8.</strong> Integration with Systems and Tools</a></li><li class="chapter-item expanded "><a href="ref/how_it_works.html"><strong aria-hidden="true">9.</strong> How PowerJoular Works</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">PowerJoular Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="overview"><a class="header" href="#overview">Overview</a></h1>
<p><a href="https://www.gnu.org/licenses/gpl-3.0"><img src="https://img.shields.io/badge/License-GPLv3-blue" alt="License: GPL v3" /></a>
<a href="https://www.adaic.org"><img src="https://img.shields.io/badge/Made%20with-Ada-blue" alt="Ada" /></a></p>
<p><img src="powerjoular.png" alt="PowerJoular Logo" /></p>
<p>PowerJoular is a command line software to monitor, in real time, the power consumption of software and hardware components.</p>
<p>PowerJoular is part of the <a href="https://www.noureddine.org/research/joular/"><img src="https://raw.githubusercontent.com/joular/.github/main/profile/joular.png" alt="Joular Project" width="64" /></a> project.</p>
<p>PowerJoular can monitor the power consumption, in real time, of the CPU and the GPU in general, and also for a specific application (through its name or PID).
It works on a Linux system and on multiple platforms (x86_64, ARM) and devices (computers, servers, Raspberry Pi, etc.).</p>
<h2 id="features"><a class="header" href="#features">Features</a></h2>
<ul>
<li>Monitor power consumption of CPU and GPU of PC/servers</li>
<li>Monitor power consumption of individual applications or processes in GNU/Linux</li>
<li>Expose power consumption to the terminal and CSV files</li>
<li>Provides a systemd service (daemon) to continuously monitor power of devices</li>
<li>Low overhead (written in Ada and compiled to native code)</li>
</ul>
<h2 id="cite-this-work"><a class="header" href="#cite-this-work">Cite this work</a></h2>
<p>To cite our work in a research paper, please cite our paper in the 18th International Conference on Intelligent Environments (IE2022).</p>
<ul>
<li><strong>PowerJoular and JoularJX: Multi-Platform Software Power Monitoring Tools</strong>. Adel Noureddine. In the 18th International Conference on Intelligent Environments (IE2022). Biarritz, France, 2022.</li>
</ul>
<pre><code>@inproceedings{noureddine-ie-2022,
  title = {PowerJoular and JoularJX: Multi-Platform Software Power Monitoring Tools},
  author = {Noureddine, Adel},
  booktitle = {18th International Conference on Intelligent Environments (IE2022)},
  address = {Biarritz, France},
  year = {2022},
  month = {Jun},
  keywords = {Power Monitoring; Measurement; Power Consumption; Energy Analysis}
}
</code></pre>
<h2 id="license"><a class="header" href="#license">License</a></h2>
<p>PowerJoular is licensed under the GNU GPL 3 license only (GPL-3.0-only).</p>
<p>Copyright (c) 2020-2023, Adel Noureddine, Université de Pau et des Pays de l'Adour.
All rights reserved. This program and the accompanying materials are made available under the terms of the GNU General Public License v3.0 only (GPL-3.0-only) which accompanies this distribution, and is available at: https://www.gnu.org/licenses/gpl-3.0.en.html</p>
<p>Author : <a href="https://www.noureddine.org/">Adel Noureddine</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="supported-platforms"><a class="header" href="#supported-platforms">Supported Platforms</a></h1>
<p>PowerJoular monitors the following platforms:</p>
<ul>
<li>PC/Servers using a RAPL supported Intel processor (since Sandy Bridge) or a RAPL supported AMD processor (since Ryzen), and optionally an Nvidia graphic card.</li>
<li>Raspberry Pi devices (multiple models) and Asus Tinker Board.</li>
</ul>
<p>In all platforms, PowerJoular works currently only on GNU/Linux.</p>
<p>On PC/Servers, PowerJoular uses powercap Linux interface to read Intel RAPL (Running Average Power Limit) energy consumption.</p>
<p>PowerJoular supports RAPL package domain (core, including integrated graphics, and dram), and for more recent processors, we support Psys package (which covers the energy consumption of the entire SoC).</p>
<p>On Raspberry Pi and Asus Tinker Board, PowerJoular uses its own research-based empirical regression models to estimate the power consumption of the ARM processor.</p>
<p>We currently support the following Raspberry Pi models and Asus Tinker Board models:</p>
<ul>
<li>Model Zero W (rev 1.1), for 32 bits OS</li>
<li>Model 1 B (rev 2), for 32 bits OS</li>
<li>Model 1 B+ (rev 1.2), for 32 bits OS</li>
<li>Model 2 B (rev 1.1), for 32 bits OS</li>
<li>Model 3 B (rev 1.2), for 32 bits OS</li>
<li>Model 3 B+ (rev 1.3), for 32 bits OS</li>
<li>Model 4 B (rev 1.1, and rev 1.2), for both 32 bits and 64 bits OS</li>
<li>Model 400 (rev 1.0), for 64 bits OS</li>
<li>Asus Tinker Board (S)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<p>PowerJoular is written in Ada and can be easily compiled, and its unique binary added to your system PATH.</p>
<p>Easy-to-use installation scripts are available in the <code>installer</code> folder.
Just open the installer folder and run the appropriate file to build and/or install or uninstall the program and systemd service.</p>
<ul>
<li><code>build-install.sh</code>: will build (using <code>gprbuild</code>) and install the program binary to <code>/usr/bin</code> and systemd service. It requires having installed GNAT and gprbuild (see <a href="guide/../ref/compilation.html">Compilation</a>).</li>
<li><code>uninstall.sh</code>: deletes the program binary and systemd service.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="quick-usage"><a class="header" href="#quick-usage">Quick Usage</a></h1>
<p>To use PowerJoular, just run the command <code>powerjoular</code>.
On PC/servers, PowerJoular uses Intel's RAPL through the Linux powercap sysfs, and therefore requires root/sudo access on the latest Linux kernels (5.10 and newer): <code>sudo powerjoular</code>.</p>
<p>By default, the software will show the power consumption of the CPU and its utilization.
The difference (increase or decrease) of power consumption from last metric will also be shown.</p>
<p>To monitor a specific application, just run PowerJoular with the <code>-a appName</code> parameter.
PowerJoular is a powerful tool with many functionalities that can be accessed using specific parameters. Check the <a href="guide/../ref/options.html">Command Line Options page</a> for the detailed list. </p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="compilation"><a class="header" href="#compilation">Compilation</a></h1>
<p>PowerJoular is written with Ada, and requires a modern Ada compiler, such as GNAT.</p>
<p>PowerJoular depends on the following commands and libraries for certain of its functions, but can function without them:</p>
<ul>
<li>nvidia-smi: for monitoring power consumption of Nvidia graphic cards</li>
<li>Linux powercap with Intel RAPL support: for monitoring power consumption of Intel processors and SoC</li>
</ul>
<p>On a modern GNU/Linux distribution, just install the GNAT compiler (and GPRBuild), usually available from the distribution's repositories:</p>
<pre><code>Fedora:
sudo dnf install fedora-gnat-project-common gprbuild gcc-gnat

Debian, Ubuntu or Raspberry Pi OS:
sudo apt install gnat gprbuild
</code></pre>
<p>For other distributions, use their package manager to download the compiler, or check <a href="https://www.noureddine.org/articles/ada-on-windows-and-linux-an-installation-guide">this article for easy instruction for various distributions</a>, including RHEL and its clones which does not ship with Ada support in GCC.</p>
<h3 id="compilation-with-the-gnat-compiler-and-gprbuild"><a class="header" href="#compilation-with-the-gnat-compiler-and-gprbuild">Compilation with the GNAT compiler and GPRBuild</a></h3>
<p>To compile the project, just type <code>gprbuild</code> if using the latest GPRBuild versions.</p>
<p>Or, on older versions, create the <code>/obj</code> folder first, then type <code>gprbuild powerjoular.gpr</code>.</p>
<p>The PowerJoular binary will be created in the <code>obj/</code> folder.</p>
<p>By default, the project will statically link the required libraries, and therefore the PowerJoular binary can be copied to any compatible system and used as-is.</p>
<p>To build with dynamic linking, remove or comment the static switch in the <code>powerjoular.gpr</code> file, in particular these lines:</p>
<pre><code>package Binder is
    for Switches (&quot;Ada&quot;) use (&quot;-static&quot;);
end Binder;
</code></pre>
<h3 id="compilation-with-the-gnat-compiler-only"><a class="header" href="#compilation-with-the-gnat-compiler-only">Compilation with the GNAT compiler only</a></h3>
<p>You can also compile PowerJoular with the GNAT compiler only (without the need for GPRBuild).</p>
<p>Just compile using gnatmake. For example, to compile from <code>obj/</code> folder (so .o and .ali files are generated there), type the following:</p>
<pre><code>mkdir -p obj
cd obj
gnatmake ../src/powerjoular.adb
</code></pre>
<h3 id="compilation-with-alire"><a class="header" href="#compilation-with-alire">Compilation with Alire</a></h3>
<p>If you have <a href="https://alire.ada.dev/">Alire</a> installed, you can use it to build PowerJoular with:</p>
<pre><code>alr build</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="command-line-options"><a class="header" href="#command-line-options">Command Line Options</a></h1>
<p>To use PowerJoular, just run the command <code>powerjoular</code>.
On PC/servers, PowerJoular uses Intel's RAPL through the Linux powercap sysfs, and therefore requires root/sudo access on the latest Linux kernels (5.10 and newer): <code>sudo powerjoular</code>.</p>
<p>By default, the software will show the power consumption of the CPU and its utilization.
The difference (increase or decrease) of power consumption from the last metric will also be shown.</p>
<p>The following options are available:</p>
<ul>
<li><code>-h</code>: show the help message</li>
<li><code>-p pid</code>: specifiy a particular PID to monitor</li>
<li><code>-a appName</code>: specifiy a particular application name to monitor (will monitor all PIDs of the application)</li>
<li><code>-f filename</code>: save monitoring data to the given filename path</li>
<li><code>-o filename</code>: save only last monitoring data to the given filename path (file overwritten with only latest power measures)</li>
<li><code>-t</code>: print data to the terminal</li>
<li><code>-l</code>: use linear regression models (less accurate than the default polynomial models) for Raspberry Pi energy models</li>
</ul>
<p>You can mix options, i.e., <code>powerjoular -tp 144</code> will monitor PID 144 and will print to the terminal.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="systemd-service"><a class="header" href="#systemd-service">Systemd Service</a></h1>
<p>A systemd service is provided and can be installed (by copying <code>powerjoular.service</code> in <code>systemd</code> folder to <code>/etc/systemd/system/</code>).
The service will run the program with the <code>-o</code> option (which only saves the latest power data) and saves data to <code>/tmp/powerjoular-service.csv</code>.
The service can be enabled to run automatically on boot.</p>
<p>The systemd service is automatically installed when installing PowerJoular using the installer script.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="integration-with-systems-and-tools"><a class="header" href="#integration-with-systems-and-tools">Integration with Systems and Tools</a></h1>
<p>PowerJoular exports its power data to CSV files, or print the values directly on the terminal.
As such, PowerJoular can be used in IDEs, integration systems CI/CD, or alongside other profilers or debugging tools.</p>
<p>All what is needed is to start PowerJoular and read the generated CSV files.
PowerJoular can write these CSV files in <code>overwrite</code> mode, and thus reducing the overhead and size of these files.</p>
<p>With the systemd service provided, PowerJoular can run automatically on startup and write power consumption to <code>/tmp</code> folder (which can be changed in the service).
Therefore, offering an automatic way for multiple tools and dashboards to get accurate and real-time power metrics in multiple platforms.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="how-powerjoular-works"><a class="header" href="#how-powerjoular-works">How PowerJoular Works</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
