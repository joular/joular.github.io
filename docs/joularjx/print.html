<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>JoularJX Documentation</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon-de23e50b.svg">
        <link rel="shortcut icon" href="favicon-8114d1fc.png">
        <link rel="stylesheet" href="css/variables-8adf115d.css">
        <link rel="stylesheet" href="css/general-2459343d.css">
        <link rel="stylesheet" href="css/chrome-ae938929.css">
        <link rel="stylesheet" href="css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex-dece1898.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc-162ede15.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">JoularJX Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="overview"><a class="header" href="#overview">Overview</a></h1>
<p><a href="https://www.gnu.org/licenses/gpl-3.0"><img src="https://img.shields.io/badge/License-GPLv3-blue" alt="License: GPL v3"></a>
<a href="https://openjdk.java.net"><img src="https://img.shields.io/badge/Made%20with-Java-orange" alt="Java"></a></p>
<p><img src="joularjx.png" alt="JoularJX Logo"></p>
<p>JoularJX is part of the <a href="https://www.noureddine.org/research/joular/"><img src="https://raw.githubusercontent.com/joular/.github/main/profile/joular.png" alt="Joular Project" width="64" /></a> project.</p>
<p>JoularJX is a Java-based agent for power monitoring at the source code level with support for modern Java versions and multi-OS to monitor power consumption of hardware and software.</p>
<p>JoularJX is a Java agent where you can simply hook it to the Java Virtual Machine when starting your Java program. To get power readings, JoularJX uses a custom PowerMonitor program (based on Hubblo’s Windows RAPL driver) on Windows, Intel RAPL (through powercap) on GNU/Linux, Powermetrics on macOS, and our accurate power models on Raspberry Pi and similar devices.</p>
<p>JoularJX is the successor of <a href="https://www.noureddine.org/research/jalen">Jalen</a>, and the core approach of statistical sampling is based and inspired by the work we did in monitoring energy hotspots in software (<a href="https://hal.inria.fr/hal-00715331/document">ASE 2012 conference paper</a>, and <a href="https://hal.inria.fr/hal-01069142/document">ASE Journal paper in 2015</a>).</p>
<p>The official website of JoularJX is: <a href="https://www.noureddine.org/research/joular/joularjx">https://www.noureddine.org/research/joular/joularjx</a>.</p>
<h2 id="features"><a class="header" href="#features">Features</a></h2>
<ul>
<li>Monitor power consumption of each method at runtime</li>
<li>Monitor the evolution of power consumption of each method</li>
<li>Monitor power consumption of methods’ call tree and execution branches</li>
<li>Monitor energy of Java applications running in virtual machines</li>
<li>Uses a Java agent, no source code instrumentation needed</li>
<li>Uses Intel RAPL (powercap interface) for getting accurate power reading on GNU/Linux, our research-based regression models on Raspberry Pi devices, and a custom program monitor (based on Intel Power Gadget) for accurate power readings on Windows</li>
<li>Provides real-time power consumption of every method in the monitored program</li>
<li>Provides total energy for every method on program exit</li>
</ul>
<h2 id="cite-this-work"><a class="header" href="#cite-this-work">Cite this work</a></h2>
<p>To cite our work in a research paper, please cite our paper in the 18th International Conference on Intelligent Environments (IE2022).</p>
<ul>
<li><strong>PowerJoular and JoularJX: Multi-Platform Software Power Monitoring Tools</strong>. Adel Noureddine. In the 18th International Conference on Intelligent Environments (IE2022). Biarritz, France, 2022.</li>
</ul>
<pre><code>@inproceedings{noureddine-ie-2022,
  title = {PowerJoular and JoularJX: Multi-Platform Software Power Monitoring Tools},
  author = {Noureddine, Adel},
  booktitle = {18th International Conference on Intelligent Environments (IE2022)},
  address = {Biarritz, France},
  year = {2022},
  month = {Jun},
  keywords = {Power Monitoring; Measurement; Power Consumption; Energy Analysis}
}
</code></pre>
<h2 id="license"><a class="header" href="#license">License</a></h2>
<p>JoularJX is licensed under the GNU GPL 3 license only (GPL-3.0-only).</p>
<p>Copyright (c) 2021-2026, Adel Noureddine, Université de Pau et des Pays de l’Adour.
All rights reserved. This program and the accompanying materials are made available under the terms of the GNU General Public License v3.0 only (GPL-3.0-only) which accompanies this distribution, and is available at: https://www.gnu.org/licenses/gpl-3.0.en.html</p>
<p>Author : <a href="https://www.noureddine.org/">Adel Noureddine</a></p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="supported-platforms"><a class="header" href="#supported-platforms">Supported Platforms</a></h1>
<p>JoularJX support the following platforms and operating systems:</p>
<ul>
<li>PC/Servers using a RAPL supported Intel processor (since Sandy Bridge) or a RAPL supported AMD processor (since Ryzen), on GNU/Linux, on Windows and on macOS.</li>
<li>Virtual machines (any supported guest on any guest)</li>
</ul>
<p>The supported list of Raspberry Pi and Asus Tinker Board models are listed below.
We support all revisions of each model lineup.
However, the model is generated and trained on a specific revision (listed between brackets), and the accuracy is best on this particular revision.</p>
<ul>
<li>Raspberry Pi devices (multiple models) on GNU/Linux:
<ul>
<li>Model Zero W (rev 1.1), for 32 bits OS</li>
<li>Model 1 B (rev 2), for 32 bits OS</li>
<li>Model 1 B+ (rev 1.2), for 32 bits OS</li>
<li>Model 2 B (rev 1.1), for 32 bits OS</li>
<li>Model 3 B (rev 1.2), for 32 bits OS</li>
<li>Model 3 B+ (rev 1.3), for 32 bits OS</li>
<li>Model 4 B (rev 1.1, and rev 1.2), for both 32 bits and 64 bits OS</li>
<li>Model 400 (rev 1.0), for 64 bits OS</li>
<li>Model 5 B (rev 1.0), for 64 bits OS</li>
</ul>
</li>
<li>Asus Tinkber Board (S)</li>
</ul>
<div class="table-wrapper">
<table>
<thead>
<tr><th style="text-align: center">Platform</th><th style="text-align: center">Supported OS</th><th style="text-align: center">Based on</th><th style="text-align: center">Supported Architecture</th></tr>
</thead>
<tbody>
<tr><td style="text-align: center">Linux PC/Server</td><td style="text-align: center">GNU/Linux</td><td style="text-align: center">RAPL (using powercap)</td><td style="text-align: center">x86, x86_64</td></tr>
<tr><td style="text-align: center">Windows PC/Server</td><td style="text-align: center">Windows</td><td style="text-align: center">Hubblo’s Windows RAPL driver</td><td style="text-align: center">x86, x86_64</td></tr>
<tr><td style="text-align: center">macOS PC</td><td style="text-align: center">macOS</td><td style="text-align: center">Powermetrics</td><td style="text-align: center">x86_64, ARM</td></tr>
<tr><td style="text-align: center">Raspberry Pi</td><td style="text-align: center">GNU/Linux</td><td style="text-align: center">Our regression models</td><td style="text-align: center">ARM</td></tr>
<tr><td style="text-align: center">Asus Tinker Board</td><td style="text-align: center">GNU/Linux</td><td style="text-align: center">Our regression models</td><td style="text-align: center">ARM</td></tr>
<tr><td style="text-align: center">Virtual Machine</td><td style="text-align: center">Supported guests (Windows, Linux, macOS), any host</td><td style="text-align: center">Host’s architecture (RAPL, regression models, others)</td><td style="text-align: center">x86, x86_64, ARM</td></tr>
</tbody>
</table>
</div>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<p>JoularJX is a Java agent, and therfore provided as a <code>.jar</code> file.
Just use the compiled jar package for JoularJX.</p>
<p>JoularJX requires, at minimum, Java 11+.</p>
<p>JoularJX gets CPU power reading from various sources, depending on the platform or operating system.
In particuliar, it can get the data from two main approaches:</p>
<ul>
<li>Get the power data from <a href="https://github.com/joular/joularcore">Joular Core</a>, either through its standard output or through a shared memory buffer ring (IPC). Joular Core works on all platforms and operating systems.</li>
<li>Get the data through its internal calculation from RAPL (Linux, Windows), powermetrics (macOS) or our own regression models (Raspberry Pi).</li>
<li>In addition, in virtual machines, JoularJX reads the power consumption of the virtual machine (measured in the host) from a file shared between the host and the guest.</li>
</ul>
<p>If using JoularJX internal calculation, you need:</p>
<ul>
<li>On Windows, to read the data from the RAPL driver, we use a custom program monitor called <a href="https://github.com/joular/WinPowerMonitor">Power Monitor for Windows</a>. It used to be part of JoularJX, but now it is in its own repository. Download the binary (or compile the source code), and specify its path in <code>config.properties</code>. Runs on Intel or AMD CPUs (since Ryzen). You can substitute that software with <a href="https://github.com/joular/joularcore">Joular Core</a>.
Either way (WinPowerMonitor or Joular Core), you need to install the <a href="https://github.com/hubblo-org/windows-rapl-driver">Windows RAPL driver by Hubblo</a>. The easiest way to install the driver is to install the windows version of <a href="https://github.com/hubblo-org/scaphandre">Scaphandre</a> tool from <a href="https://github.com/hubblo-org/scaphandre/releases/download/v1.0.0/scaphandre_v1.0.0_installer.exe">this link directly</a> (release 1.0.0).</li>
<li>On PC/server GNU/Linux, JoularJX uses Intel RAPL interface through powercap, and therefore requires running on an Intel CPU or an AMD CPU (since Ryzen).</li>
<li>On macOS, JoularJX uses <code>powermetrics</code>, a tool bundled with macOS which requires running with <code>sudo</code> access. It is recommended to authorize the current users to run <code>/usr/bin/powermetrics</code> without requiring a password by making the proper modification to the <code>sudoers</code> file.</li>
<li>On Raspberry Pi devices on GNU/Linux, JoularJX uses our own research-based regression models to estimate CPU power consumption with support for the following device models (we support all revisions of each model lineup.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="quick-usage"><a class="header" href="#quick-usage">Quick Usage</a></h1>
<p>JoularJX is a Java agent where you can simply hook it to the Java Virtual Machine when starting your Java program’s main class:</p>
<pre><code>java -javaagent:joularjx-$version.jar YourProgramMainClass
</code></pre>
<p>If your program is a JAR file, then just run it as usual while adding JoularJX:</p>
<pre><code>java -javaagent:joularjx-$version.jar -jar yourProgram.jar
</code></pre>
<p>JoularJX will generate multiple CSV files according to the configuration settings (in <code>config.properties</code>), and will create these files in a <code>joularjx-results</code>folder.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="compilation"><a class="header" href="#compilation">Compilation</a></h1>
<p>To build JoularJX, you need Java 11+ and Maven, then just build:</p>
<pre><code>mvn clean install
</code></pre>
<p>Alternatively, you can use the Maven wrappen shipped with the project with the command:</p>
<pre><code>Linux and macOS: ./mvnw clean install
Windows: mvnw.cmd clean install
</code></pre>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="configuration-properties"><a class="header" href="#configuration-properties">Configuration Properties</a></h1>
<p>JoularJX can be configured by modifying the <code>config.properties</code> files:</p>
<ul>
<li><code>filter-method-names</code>: list of strings which will be used to filter the monitored methods (see Generated files below for explanations).</li>
<li><code>save-runtime-data</code>: write runtime methods power consumption in a CSV file.</li>
<li><code>overwrite-runtime-data</code>: overwrite runtime power data files, or if set to false, it will write new files for each monitoring cycle.</li>
<li><code>logger-level</code>: set the level of information (by logger) given by JoularJX in the terminal (allowed values: OFF, INFO, WARNING, SEVERE).</li>
<li><code>powermonitor-path</code>: Full path to the power monitor program (only for Windows).</li>
<li><code>track-consumption-evolution</code>: generate CSV files for each method containing details of the method’s consumption over the time. Each consumption value is mapped to an Unix timestamp.</li>
<li><code>hide-agent-consumption</code>: if set to true, the energy consumption of the agent threads will not be reported.</li>
<li><code>enable-call-trees-consumption</code>: compute methods call trees energy consumption. A CSV file will be generated at the end of the agent’s execution, associating to each call tree it’s total energy consumption.</li>
<li><code>save-call-trees-runtime-data</code>: write runtime call trees power consumption in a CSV file. For each monitoring cycle (1 second), a new CSV file will be generated, containing the runtime power consumption of the call trees. The generated files will include timestamps in their names.</li>
<li><code>overwrite-call-trees-runtime-data</code>: overwrite runtime call trees power data file, or if set to false, it will write new file for each monitoring cycle.</li>
<li><code>application-server</code>: properly handles application servers and frameworks (Sprig Boot, Tomcat, etc.). Set <code>true</code> when running on application servers. If <code>false</code>, the monitoring loop will check if the JVM is destroyed, hence closing JoularJX when the application ends (in regular Java application). If <code>true</code>, JoularJX will continue to monitor correctly as the JVM isn’t destroyed in a application server.</li>
<li><code>vm-power-path</code>: the path for the power consumption of the virtual machine. Inside a virtual machine, indicate the file containing power consumption of the VM (which is usually a file in the host that is shared with the guest).</li>
<li><code>vm-power-format</code>: power format of the shared VM power file. We currently support two formats: <code>watts</code> (a file containing one float value which is the power consumption of the VM), and <code>powerjoular</code> (a csv file generated by <a href="https://github.com/joular/powerjoular">PowerJoular</a> in the host, containing 3 columns: timestamp, CPU utilization of the VM and CPU power of the VM).</li>
<li><code>joular-core</code>: if set to <code>true</code>, use Joular Core instead of JoularJX internal CPU power calculations.</li>
<li><code>joular-core-ring-buffer</code>: if <a href="https://github.com/joular/joularcore">Joular Core</a> is set to <code>true</code>, and this property is also set to <code>true</code>, then get power data from Joular Core through a shareed memory ring buffer.</li>
<li><code>joular-core-path</code>: the full path of <a href="https://github.com/joular/joularcore">Joular Core</a> binary.</li>
<li><code>joular-core-parameters</code>: the parameters to run Joular Core with. It must be <code>-c cpu -i</code>.</li>
<li><code>joular-core-ringbuffer-path</code>: the path to Joular Core ring buffer.</li>
<li></li>
</ul>
<p>You can install the jar package (and the PowerMonitor.exe on Windows) wherever you want, and call it in the <code>javaagent</code> with the full path.
However, <code>config.properties</code> must be copied to the same folder as where you run the Java command.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="generated-files"><a class="header" href="#generated-files">Generated Files</a></h1>
<p>JoularJX will generate multiple CSV files according to the configuration settings (in <code>config.properties</code>), and will create these files in a <code>joularjx-results</code>folder.</p>
<p>The generated files are available under the following folder structure:</p>
<ul>
<li>joularjx-results
<ul>
<li>appName-PID-start_timestamp
<ul>
<li>all (power/energy data for all methods, including the JDK ones)
<ul>
<li>runtime (power consumption every second)
<ul>
<li>calltree (consumption for each call tree branch)</li>
<li>methods (consumption for each methods)</li>
</ul>
</li>
<li>total (total energy consumption, generated at the program’s end)
<ul>
<li>calltree</li>
<li>methods</li>
</ul>
</li>
<li>evolution (power consumption evolution of every method, throughout the execution of the application)</li>
</ul>
</li>
<li>app (power/energy data for methods of the monitored application, according to the <code>filter-method-names</code> setting)
<ul>
<li>runtime
<ul>
<li>calltree</li>
<li>methods</li>
</ul>
</li>
<li>total
<ul>
<li>calltree</li>
<li>methods</li>
</ul>
</li>
<li>evolution</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The folder structure is summarized in the following figure:</p>
<p><img src="ref/joularjx2-results.png" alt="JoularJX folder structure"></p>
<p>For real-time power data or the total energy at the program exit, JoularJX generated two CSV files:</p>
<ul>
<li>A file which contains power or energy data for all methods, which include the JDK’s ones.</li>
<li>A <em>filtered file</em> which only includes the power or energy data of those filtered methods (can be configured in <code>config.properties</code>). This data is not just a subset of the first data file, but rather a recalculation done by JoularJX to provide accurate data: methods that start with the filtered keyword, will be allocated the power or energy consumed by the JDK methods that it calls.</li>
</ul>
<p>For example, if <code>Package1.MethodA</code> calls <code>java.io.PrintStream.println</code> to print some text to a terminal, then we calculate:</p>
<ul>
<li>In the first file, the power or energy consumed by <code>println</code> separately from <code>MethodA</code>. The latter power consumption won’t include those consumed by <code>println</code>.</li>
<li>In the second file, if we filter methods from <code>Package1</code>, then the power consumption of <code>println</code> will be added to <code>MethodA</code> power consumption, and the file will only provide power or energy of <code>Package1</code> methods.</li>
</ul>
<p>We manage to do this by analyzing the stacktrace of all running threads on runtime.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="integration-with-systems-and-tools"><a class="header" href="#integration-with-systems-and-tools">Integration with Systems and Tools</a></h1>
<p>JoularJX is a Java agent, and the compiled JAR file have no external dependencies.
Therefore, it can be integrated and used in any Java-based virtual machine and setup.</p>
<p>For instance, you can add JoularJX to the run/execute parameters of your favorite IDE (Eclipse, IntelliJ Idea, NetBeans, etc.), or to your development workflow or continuous integration and delivery processes (CI/CD).</p>
<p>JoularJX runs indistinctly and with the same configuration options and generated files on all supported platforms, from Windows to Linux, from x86_64 servers and PC to ARM Raspberry Pi devices.</p>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="virtual-machines"><a class="header" href="#virtual-machines">Virtual Machines</a></h1>
<p>JoularJX also works inside virtual machines.
All its functionalities work the same inside a virtual machine as with bare metal installation.</p>
<p>In virtual machines, JoularJX in the guest OS needs to get the power consumption of the virtual machine instance itself.
This can only be done by installing on the host OS, a power monitoring tool (such as PowerJoular or other ones), and monitoring the power consumption of the specific guest virtual machine process.</p>
<p>The power data of the VM process need to be written to a shared file between the host and the guest.
Inside the guest, JoularJX will read this file continuously and use the reported power value as the power of the entire virtual machine.</p>
<p>JoularJX is agnostic to what power tools in installed in the host and can work with any available tool that is capable of monitoring the VM process.</p>
<h2 id="use-case-example-with-joularjx-on-guest-and-joular-core-or-powerjoular-on-host"><a class="header" href="#use-case-example-with-joularjx-on-guest-and-joular-core-or-powerjoular-on-host">Use case example with JoularJX on guest and Joular Core or PowerJoular on host</a></h2>
<p>A use case example is using JoularJX on the guest OS and PowerJoular on the host OS.</p>
<h3 id="in-the-host-os"><a class="header" href="#in-the-host-os">In the host OS</a></h3>
<ul>
<li>Install <a href="https://github.com/joular/joularcore">Joular Core</a> or <a href="https://github.com/joular/powerjoular">PowerJoular</a></li>
<li>Run Joular Core or PowerJoular while specifying the PID of the virtual machine of the guest OS, and writing the power data in a CSV file in overwrite mode.</li>
<li>For instance, you can run PowerJoular with the following command: <code>powerjoular -p $VM_PID -o /home/vm/vm.csv</code></li>
<li>Share the <code>/home/vm/vm.csv</code> between the host OS and the guest OS</li>
</ul>
<h2 id="in-the-guest-os"><a class="header" href="#in-the-guest-os">In the guest OS</a></h2>
<ul>
<li>Get and compile JoularJX</li>
<li>Share the <code>/home/vm/vm.csv</code> between the host OS and the guest OS, potentially having a different path of the file inside the guest. For instance, <code>/opt/vm/vm.csv</code></li>
<li>Modify <code>config.properties</code> and set ``vm-power-path<code>to the shared file</code>/opt/vm/vm.csv<code>, and </code>vm-power-format<code>to the proper format (in this case to</code>powerjoular```).</li>
<li>Start your Java application with JoularJX agent as usual.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div>
<h1 id="how-joularjx-works"><a class="header" href="#how-joularjx-works">How JoularJX Works</a></h1>
<p>JoularJX is a Java agent that hooks to the Java Virtual Machine (JVM) on startup along with the monitored application.
It runs in a separate thread and collects information about CPU usage of the JVM process, each thread running in the JVM, and then for each method of the application.</p>
<p><a href="https://www.noureddine.org/research/joular/joularjx">JoularJX</a> is the successor of <a href="https://www.noureddine.org/research/jalen">Jalen</a>, and the core approach of statistical sampling is based and inspired by the work we did in monitoring energy hotspots in software (<a href="https://hal.inria.fr/hal-00715331/document">ASE 2012 conference paper</a>, and <a href="https://hal.inria.fr/hal-01069142/document">ASE Journal paper in 2015</a>).
JoularJX version 1 is described in our newer research paper at the <a href="https://hal.science/hal-03608223v1/document">IE 2022 conference</a>.</p>
<p>The general architecture of JoularJX is summarized in the following figure:</p>
<p><img src="ref/joularjx-architecture-1.png" alt="JoularJX General Architecture"></p>
<p>The monitoring process is as follows:</p>
<ul>
<li>Every application monitoring cycle (by default, 1 second), JoularJX collects the CPU usage of the JVM and calculates the power consumption of the entire JVM (on Windows, using the PowerMonitor.exe program using Intel API, on x86_64 Linux using RAPL interface in the Linux kernel, and on Raspberry Pi and Asus Tinker Board using our regression power models).</li>
<li>Then, JoularJX collects the CPU usage of each thread in the JVM using the JDK’s <code>getThreadCpuTime</code> method, and calculates the power consumption of each thread.</li>
<li>Every source code monitoring cycle (by default, 10 milliseconds), JoularJX checks, for each thread, the stacktrace and identify the method being executed (the method on top of the stacktrace). At the end of the application monitoring cycle, JoularJX statistically analyzes the ratio of each method observed in the stacktrace, and allocate the power consumption accordingly as seen in the following figures:</li>
</ul>
<p><img src="ref/joularjx-architecture-2.png" alt="JoularJX Simplified Architecture"></p>
<p><img src="ref/joularjx-architecture-3.png" alt="JoularJX Simplified Approach to Monitor Power per Method"></p>
<p>Usually the method on the top of the stacktrace is a method from the JDK.
For example, calling <code>System.out.println()</code> from the application’s method <code>Main</code> will call other methods from the JDK (such as buffers, writeln, etc.).
JoularJX will verify, when checking the stacktrace, if the method is called, anywhere in its call tree, by a method from the application we wish to monitor, and thus isolate these statistics from methods called by other applications or by the JoularJX agent itself.</p>
<p>During these monitoring cycles, JoularJX not only identify the method being executed, but also its execution branch (all the methods calling it), and can provide power and energy consumption for each execution branch as seen in the following figures:</p>
<p><img src="ref/method-callree.png" alt="Methods Call Tree"></p>
<p><img src="ref/calltree.png" alt="Methods Call Tree"></p>
<p>JoularJX will also automatically calculate the power consumption for each method, for each timestamp, thus allowing to trace the power consumption evolution of each method, as seen in the following figure:</p>
<p><img src="ref/joularjx2-evolution.png" alt="Methods Power Evolution"></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr-ef4e11c1.min.js"></script>
        <script src="mark-09e88c2c.min.js"></script>
        <script src="searcher-c2a407aa.js"></script>

        <script src="clipboard-1626706a.min.js"></script>
        <script src="highlight-abc7f01d.js"></script>
        <script src="book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>


    </div>
    </body>
</html>
